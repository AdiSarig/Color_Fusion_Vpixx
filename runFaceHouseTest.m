%% This script runs one session of the triangulation paradigm.% For each block (run) of trials, calls oneRun.m and also saves backup of% data from that run.%% It is assumed that a session object already exists and has been% intialized. This is a script instead of a function to make it easier to% resume the session in the event of an error or problem.%% 10 June 2021%%%%%%%%%%%%%%%%%%%%%%%%%%%session.imgPath = imgPath;%%%%%%%%%%%%%%%%%%%%%%%%%%nRuns = 2;nTrialsPerRun = 96;[TRIALS] = prepTrials(nRuns,nTrialsPerRun,session);session.test.nRuns = nRuns;session.test.nTrialsPerRun = nTrialsPerRun;% get rid of blue dot trials[TRIALS.blueDot] = deal(false);try    w=[];    for iRun=1:nRuns         runNum = [iRun, nRuns];        trialsThisRun = [(iRun-1)*nTrialsPerRun+1 : iRun*nTrialsPerRun];        [trials,w]=oneRun(imgPath,TRIALS(trialsThisRun),session.params,w,runNum,2,false);        if isempty(w)            Screen('closeall'); % just in case!            warning('Aborted. You may still want to save a final copy of the data.')            return        end        % emergency backup save        save(sprintf('subj%02d_sess%02d_test%02d_%s.mat',session.subjnum,session.sessnum,iRun,datestr(now,30)),'trials');        session.test.run(iRun).trials = trials;        WaitSecs(0.5);        %session.test.run(iRun).checkFusion = CheckFusion(w,session.params);    end        w = closePsychToolboxWindows(w);    catch    ListenChar(0);    ShowCursor;    Screen('closeall');    rethrow(lasterror);end%-- END --%